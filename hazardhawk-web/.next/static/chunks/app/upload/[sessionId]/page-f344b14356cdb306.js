(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[508],{1356:(e,r,s)=>{Promise.resolve().then(s.bind(s,3699))},3699:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>c});var t=s(5155),a=s(2115),n=s(63),o=s(1514),i=s(6181);function l(e){let{onScanSuccess:r,onScanError:s,className:n=""}=e,[l,c]=(0,a.useState)({type:"idle"}),d=(0,a.useRef)(null),m=(0,a.useRef)("qr-scanner-".concat(Math.random().toString(36).substring(7))),x=(0,a.useRef)(!1),h=async()=>{if(d.current&&x.current)try{await d.current.stop(),x.current=!1}catch(e){console.error("Error stopping scanner:",e)}},u=async()=>{if(x.current)return void console.log("Scanner already running");c({type:"requesting-permission"});try{d.current||(d.current=new o.j9(m.current)),c({type:"starting"}),await d.current.start({facingMode:"environment"},{fps:10,qrbox:{width:250,height:250},aspectRatio:1},e=>{g(e)},e=>{e.includes("NotFoundException")||console.debug("QR Scan error:",e)}),x.current=!0,c({type:"scanning"})}catch(r){x.current=!1;let e=p(r);c({type:"error",message:e}),null==s||s(e)}},g=async e=>{console.log("QR Code scanned:",e),await h();try{let s=(0,i.oA)(e);c({type:"success",data:s}),r(s)}catch(r){let e=r instanceof Error?r.message:"Invalid QR code data";c({type:"error",message:e}),null==s||s(e)}},p=e=>e instanceof Error?e.message.includes("Permission denied")?"Camera permission denied. Please enable camera access in your browser settings.":e.message.includes("NotFoundError")?"No camera found. Please ensure your device has a camera.":e.message.includes("NotAllowedError")?"Camera access not allowed. Please grant permission to use the camera.":e.message.includes("NotReadableError")?"Camera is already in use by another application.":e.message:"Failed to access camera. Please try again.";(0,a.useEffect)(()=>()=>{h()},[]);let b=()=>{c({type:"idle"})};return(0,t.jsxs)("div",{className:"qr-scanner-container ".concat(n),children:[(0,t.jsxs)("div",{className:"relative bg-gray-900 rounded-lg overflow-hidden",children:[(0,t.jsx)("div",{id:m.current,className:"w-full min-h-[300px] md:min-h-[400px]"}),"idle"===l.type&&(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-900",children:(0,t.jsxs)("div",{className:"text-center p-6",children:[(0,t.jsx)("svg",{className:"w-24 h-24 mx-auto mb-4 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})}),(0,t.jsx)("p",{className:"text-gray-400 text-lg",children:"Ready to scan QR code"})]})}),"requesting-permission"===l.type&&(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-900 bg-opacity-90",children:(0,t.jsxs)("div",{className:"text-center p-6",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-gray-600 border-t-blue-500 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-300 text-lg",children:"Requesting camera access..."})]})}),"starting"===l.type&&(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-900 bg-opacity-90",children:(0,t.jsxs)("div",{className:"text-center p-6",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-gray-600 border-t-blue-500 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-300 text-lg",children:"Starting camera..."})]})}),"scanning"===l.type&&(0,t.jsx)("div",{className:"absolute top-0 left-0 right-0 p-4 bg-gradient-to-b from-black to-transparent",children:(0,t.jsx)("p",{className:"text-white text-center text-sm font-medium",children:"Position QR code within the frame"})}),"success"===l.type&&(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-green-900 bg-opacity-90",children:(0,t.jsxs)("div",{className:"text-center p-6",children:[(0,t.jsx)("svg",{className:"w-20 h-20 mx-auto mb-4 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,t.jsx)("p",{className:"text-green-100 text-xl font-semibold mb-2",children:"QR Code Scanned!"}),l.data.workerName&&(0,t.jsxs)("p",{className:"text-green-200",children:["Worker: ",l.data.workerName]})]})}),"error"===l.type&&(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-red-900 bg-opacity-90",children:(0,t.jsxs)("div",{className:"text-center p-6 max-w-md",children:[(0,t.jsx)("svg",{className:"w-16 h-16 mx-auto mb-4 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,t.jsx)("p",{className:"text-red-100 text-lg font-semibold mb-2",children:"Scan Failed"}),(0,t.jsx)("p",{className:"text-red-200 text-sm",children:l.message})]})})]}),(0,t.jsxs)("div",{className:"mt-6 flex gap-4 justify-center",children:["idle"===l.type&&(0,t.jsx)("button",{onClick:u,className:"px-8 py-4 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg shadow-lg transition-colors text-lg min-w-[200px]",children:"Start Scanning"}),"scanning"===l.type&&(0,t.jsx)("button",{onClick:h,className:"px-8 py-4 bg-red-600 hover:bg-red-700 text-white font-semibold rounded-lg shadow-lg transition-colors text-lg min-w-[200px]",children:"Stop Scanning"}),"error"===l.type&&(0,t.jsx)("button",{onClick:b,className:"px-8 py-4 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg shadow-lg transition-colors text-lg min-w-[200px]",children:"Try Again"}),"success"===l.type&&(0,t.jsx)("button",{onClick:b,className:"px-8 py-4 bg-gray-600 hover:bg-gray-700 text-white font-semibold rounded-lg shadow-lg transition-colors text-lg min-w-[200px]",children:"Scan Another"})]}),(0,t.jsxs)("div",{className:"mt-6 p-4 bg-gray-100 rounded-lg",children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900 mb-2",children:"How to scan:"}),(0,t.jsxs)("ol",{className:"list-decimal list-inside space-y-1 text-sm text-gray-700",children:[(0,t.jsx)("li",{children:'Click "Start Scanning" and allow camera access'}),(0,t.jsx)("li",{children:"Point your camera at the QR code"}),(0,t.jsx)("li",{children:"Hold steady until the code is recognized"}),(0,t.jsx)("li",{children:"You'll be redirected to the upload form automatically"})]})]})]})}function c(){let e=(0,n.useRouter)(),[r,s]=(0,a.useState)({type:"scanning"}),[o,i]=(0,a.useState)(!1);(0,a.useEffect)(()=>{i(!0)},[]);let c=async r=>{console.log("QR scan successful:",r),s({type:"scanned",data:r}),setTimeout(()=>{s({type:"transitioning"});let t=new URL("/upload",window.location.origin);t.searchParams.set("workerId",r.workerId),t.searchParams.set("projectId",r.projectId),t.searchParams.set("companyId",r.companyId),t.searchParams.set("sessionId",r.uploadSessionId),r.workerName&&t.searchParams.set("workerName",r.workerName),e.push(t.pathname+t.search)},1500)};return o?(0,t.jsxs)("main",{className:"min-h-screen bg-gradient-to-b from-gray-50 to-gray-100",children:[(0,t.jsx)("header",{className:"bg-white shadow-sm border-b border-gray-200",children:(0,t.jsx)("div",{className:"max-w-4xl mx-auto px-4 py-6",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-12 h-12 bg-blue-600 rounded-lg flex items-center justify-center",children:(0,t.jsx)("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"HazardHawk"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Certification Upload Portal"})]})]})})}),(0,t.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-8",children:["scanning"===r.type&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"mb-8 text-center",children:[(0,t.jsx)("h2",{className:"text-3xl font-bold text-gray-900 mb-3",children:"Upload Your Certification"}),(0,t.jsx)("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"Scan the QR code provided by your safety lead to begin uploading your certification documents."})]}),(0,t.jsx)("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-8",children:(0,t.jsx)(l,{onScanSuccess:c,onScanError:e=>{console.error("QR scan error:",e),s({type:"error",message:e})}})}),(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-6 mb-8",children:[(0,t.jsx)("div",{className:"bg-blue-50 border-2 border-blue-200 rounded-lg p-6",children:(0,t.jsxs)("div",{className:"flex items-start gap-4",children:[(0,t.jsx)("div",{className:"w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center flex-shrink-0",children:(0,t.jsx)("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900 mb-2",children:"Need a QR Code?"}),(0,t.jsx)("p",{className:"text-sm text-gray-700",children:"Ask your safety lead or project manager to generate a QR code for you from the HazardHawk mobile app."})]})]})}),(0,t.jsx)("div",{className:"bg-green-50 border-2 border-green-200 rounded-lg p-6",children:(0,t.jsxs)("div",{className:"flex items-start gap-4",children:[(0,t.jsx)("div",{className:"w-10 h-10 bg-green-600 rounded-lg flex items-center justify-center flex-shrink-0",children:(0,t.jsx)("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900 mb-2",children:"Secure Upload"}),(0,t.jsx)("p",{className:"text-sm text-gray-700",children:"Your certification documents are encrypted and securely stored in compliance with industry standards."})]})]})})]})]}),"scanned"===r.type&&(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[(0,t.jsx)("div",{className:"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6",children:(0,t.jsx)("svg",{className:"w-12 h-12 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-3",children:"QR Code Scanned!"}),r.data.workerName&&(0,t.jsxs)("p",{className:"text-lg text-gray-600 mb-2",children:["Welcome, ",(0,t.jsx)("span",{className:"font-semibold",children:r.data.workerName})]}),(0,t.jsx)("p",{className:"text-gray-500",children:"Preparing upload form..."})]}),"transitioning"===r.type&&(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-gray-200 border-t-blue-600 mx-auto mb-6"}),(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-3",children:"Loading Upload Form"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Please wait..."})]}),"error"===r.type&&(0,t.jsx)("div",{className:"bg-white rounded-xl shadow-lg p-8",children:(0,t.jsxs)("div",{className:"text-center mb-6",children:[(0,t.jsx)("div",{className:"w-20 h-20 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-6",children:(0,t.jsx)("svg",{className:"w-12 h-12 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-3",children:"Scan Failed"}),(0,t.jsx)("p",{className:"text-red-600 mb-6",children:r.message}),(0,t.jsx)("button",{onClick:()=>s({type:"scanning"}),className:"px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg shadow transition-colors",children:"Try Again"})]})}),(0,t.jsx)("div",{className:"mt-8 text-center text-sm text-gray-500",children:(0,t.jsxs)("p",{children:["Having trouble? Contact your safety lead or email"," ",(0,t.jsx)("a",{href:"mailto:support@hazardhawk.com",className:"text-blue-600 hover:underline",children:"support@hazardhawk.com"})]})})]})]}):(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-gray-300 border-t-blue-600"})})}},6181:(e,r,s)=>{"use strict";s.d(r,{Ck:()=>i,oA:()=>o,yL:()=>l});var t=s(2769),a=s(7381);let n=a.Ikc({workerId:a.YjP().min(1,"Worker ID is required"),projectId:a.YjP().min(1,"Project ID is required"),companyId:a.YjP().min(1,"Company ID is required"),workerName:a.YjP().optional(),uploadSessionId:a.YjP().min(1,"Upload session ID is required")});function o(e){try{let r=JSON.parse(e);return n.parse(r)}catch(e){if(e instanceof a.GaX){let r=e.issues.map(e=>"".concat(e.path.join("."),": ").concat(e.message));throw Error("Invalid QR code data: ".concat(r.join(", ")))}if(e instanceof SyntaxError)throw Error("Invalid QR code format: not valid JSON");throw Error("Failed to parse QR code data")}}async function i(e,r){try{let s=n.parse(e),a=JSON.stringify(s);return await t.toDataURL(a,{width:(null==r?void 0:r.width)||512,margin:(null==r?void 0:r.margin)||2,errorCorrectionLevel:(null==r?void 0:r.errorCorrectionLevel)||"M",color:{dark:"#000000",light:"#FFFFFF"}})}catch(e){if(e instanceof a.GaX){let r=e.issues.map(e=>"".concat(e.path.join("."),": ").concat(e.message));throw Error("Invalid worker data: ".concat(r.join(", ")))}throw Error("Failed to generate QR code")}}function l(e){return{workerId:"test-worker-001",projectId:"test-project-001",companyId:"test-company-001",workerName:"John Doe",uploadSessionId:"session-".concat(Date.now()),...e}}}},e=>{e.O(0,[604,490,35,441,255,358],()=>e(e.s=1356)),_N_E=e.O()}]);